!function(e){function t(t){for(var n,r,l=t[0],o=t[1],c=t[2],m=0,u=[];m<l.length;m++)r=l[m],i[r]&&u.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);u.length;)u.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,l=1;l<a.length;l++){var o=a[l];0!==i[o]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},i={3:0},s=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="../";var l=window.webpackJsonp=window.webpackJsonp||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=o;s.push([190,0]),a()}({176:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjEzcHgiIGhlaWdodD0iMTNweCIgdmlld0JveD0iMCAwIDEzIDEzIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTEgKDU3NDYyKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4NCiAgICA8dGl0bGU+5bey5a6M5oiQPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IuW3suWujOaIkCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIGlkPSLmraPnoa4iIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xLjAwMDAwMCwgLTIuMDAwMDAwKSI+DQogICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlLTIwIiBmaWxsPSIjMkQ2RURCIiB4PSIxIiB5PSIyIiB3aWR0aD0iMTMiIGhlaWdodD0iMTMiIHJ4PSI2LjUiPjwvcmVjdD4NCiAgICAgICAgICAgIDxwb2x5bGluZSBpZD0iUGF0aC0yIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgcG9pbnRzPSIxMC41IDcgNy4xMjUgMTEgNC41IDguNDU0NTQ1NDUiPjwvcG9seWxpbmU+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4="},180:function(e,t,a){e.exports=a.p+"./fonts/rotate_90.svg"},181:function(e,t,a){e.exports=a.p+"./fonts/rotate_right.svg"},182:function(e,t,a){e.exports=a.p+"./fonts/rotate_left.svg"},183:function(e,t,a){e.exports=a.p+"./fonts/image_small.svg"},184:function(e,t,a){e.exports=a.p+"./fonts/image_enlarge.svg"},190:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(10),r=a.n(s),l=a(314),o=a(313),c=a(315),d=a(52),m=(a(391),a(386),a(384),a(79)),u=a(12),_=a.n(u),h=a(3),g=a.n(h),p=a(6),b=a.n(p),v=a(4),f=a.n(v),y=a(5),k=a.n(y),E=(a(378),a(59)),w=a.n(E),C=a(50),x=a.n(C),N=a(78),S=a.n(N),I=window.require("electron").ipcRenderer;function A(e){var t=window.location.href;e&&(t=e);var a=t.indexOf("?");a>-1&&(t=t.substring(0,a));var n=t.split("/");return console.log(n),(n=n.reverse()).length>0?n[0]:"other"}var D=function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e)),n="normal"===A()?"正常试卷":"异常试卷";return a.state={title:a.props.title||n},a.onCloseWindow=a.onCloseWindow.bind(a),a.onMiniWindow=a.onMiniWindow.bind(a),a}return k()(t,e),b()(t,[{key:"onCloseWindow",value:function(){I.send("message-except-window-close","")}},{key:"componentDidMount",value:function(){var e=this;I.on("message-link-to-route",function(t,a){console.log("<------------------------\x3e"),console.log(a),console.log("tail_route: "+A()),"normal"===A(a)?e.setState({title:"正常试卷"}):e.setState({title:"异常试卷"});var n=Date.parse(new Date);window.location.href=a+"?t="+n})}},{key:"componentWillUnmount",value:function(){I.removeAllListeners("message-link-to-route"),this.setState=function(e,t){}}},{key:"onMiniWindow",value:function(){I.send("message-except-window-mini","")}},{key:"render",value:function(){return i.a.createElement("div",{className:"sub_page"},i.a.createElement("div",{className:"sub_page_header"},i.a.createElement("div",{className:"logo"},i.a.createElement("img",{src:w.a}),i.a.createElement("span",{className:"title"},this.state.title)),i.a.createElement("div",{className:"mini",onClick:this.onMiniWindow},i.a.createElement("img",{src:S.a})),i.a.createElement("div",{className:"close",onClick:this.onCloseWindow},i.a.createElement("img",{src:x.a}))),i.a.createElement("div",{className:"sub_page_content"},this.props.children))}}]),t}(n.Component),R=(a(118),a(67)),L=(a(31),a(13)),z=a(21),G=a.n(z),P=(a(117),a(33)),j=(a(88),a(41)),Z=a(69),M=a(9),W=(a(366),a(11)),B=a.n(W),U=a(184),T=a.n(U),H=a(183),J=a.n(H),O=a(182),V=a.n(O),Y=a(181),X=a.n(Y),Q=a(180),K=a.n(Q),F=(a(245),P.a.Group,window.require("electron")),q=F.ipcRenderer,$=F.remote,ee=(window.require("child_process").exec,$.app.getVersion(),{rate_x:0,rate_y:0,rate_w:1,rate_h:1});function te(e){var t;return t=/(\-*\d+\.*\d*)/.exec(e),e&&t?parseFloat(t[1]):0}function ae(e,t,a){var n=e.width(),i=e.height(),s=B()("#pic_image")[0].naturalWidth,r=B()("#pic_image")[0].naturalHeight;console.log(">>>>w:"+n+", h"+i),console.log(">>>>img_w:"+s+", "+r);var l=0,o=0,c=t;console.log(c);var d=c.suggest_w,m=c.suggest_h;console.log(">>>>page_w:"+d+", page_h"+m),(m>r||d>s)&&(d=s,m=r),d&&m||(d=s,m=r);var u=c.rects,_=d/s,h=m/r;_&&h||(_=1,h=1);var g=n*_,p=i*h,b=B()("<div>");function v(e,t,a,n,i,s){var r=B()("<div>");return r.addClass("recognition_rect"),r.css({position:"absolute",width:100*t+"%",height:100*a+"%",left:100*n+"%",top:100*i+"%"}),s?r.css({background:"rgba(255,121,107,.4)"}):r.css({border:"1px solid #ff786f"}),e.append(r),r}a?(l=a.offset.x*n,o=a.offset.y*i):(l=(n-g)/2,o=(i-p)/2),e.find(".tp_recognition_cover").remove(),b.addClass("tp_recognition_cover"),b.css({width:g,height:p,position:"absolute",left:l,top:o,cursor:"move",border:"1px solid #FBA478"}),b.append('<div class="lt corner"></div>'),b.append('<div class="lb corner"></div>'),b.append('<div class="rt corner"></div>'),b.append('<div class="rb corner"></div>'),b.append('<div class="l byline"></div>'),b.append('<div class="t byline"></div>'),b.append('<div class="r byline"></div>'),b.append('<div class="b byline"></div>'),B.a.each(u,function(e,t){var a=t.w,n=t.h,i=t.x,s=t.y,r=t.box_w,l=t.box_h,o=t.box_hspace,c=t.box_vspace,d=t.box_h_count,m=t.box_v_count,u=v(b,a,n,i,s);if(d&&m)for(var _=0;_<d;_++)for(var h=0;h<m;h++){var g=r/a,p=l/n;v(u,g,p,_*g+_*(o/a),h*p+h*(c/n),!0)}}),function(e){e.mousedown(function(t){var a,n,i,s,r,l,o,c,d=B()(this),m=document,u=t.target,_=B()(u),h="create";if(t.stopPropagation(),_.hasClass("corner")||_.hasClass("byline")){var g=function(e){var t="",a="",n=!1;e.hasClass("lt")?(t="left",a="top",n=!0):e.hasClass("lb")?(t="left",a="bottom",n=!0):e.hasClass("rb")?(t="right",a="bottom",n=!0):e.hasClass("rt")?(t="right",a="top",n=!0):e.hasClass("l")?t="left":e.hasClass("r")?t="right":e.hasClass("t")?a="top":e.hasClass("b")&&(a="bottom");return{horizontal:t,vertical:a,inProportion:n}}(_);h="size",o=g.horizontal,c=g.vertical,g.inProportion}else h="move";function p(e){e.preventDefault();var t=Math.round(e.pageX-r),m=Math.round(e.pageY-l),u=a,_=n,g=i,p=s;"move"===h?(u=a+t,_=n+m,console.log("move")):"size"===h&&(console.log(h,o,c),"left"===o&&(g=i-t,u=a+t),"right"===o&&(g=i+t),"top"===c&&(p=s-m,_=n+m),"bottom"===c&&(p=s+m)),"move"===h?d.css({left:u,top:_}):"size"===h&&d.css({left:u,top:_,width:g,height:p}),ee={rate_x:1*u/B()("#pic_image").width(),rate_y:1*_/B()("#pic_image").height(),rate_w:1*g/B()("#pic_image").width(),rate_h:1*p/B()("#pic_image").height()}}function b(e){e.preventDefault()}e.hasClass("static")||(a=te(d.css("left")),n=te(d.css("top")),i=d.width(),s=d.height(),r=t.pageX,l=t.pageY,B()(m).mousemove(p).mouseup(function e(t){t.preventDefault();B()(m).unbind("mousemove",p).unbind("mouseup",e).unbind("selectstart",b)}).bind("selectstart",b))})}(b),e.append(b)}var ne=function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.state={abnormal_id:e.abnormal_id,const_abnormal_id:e.abnormal_id,has_recognized:!1,student_id:e.student_id,tail_route:function(){var e=window.location.href,t=e.indexOf("?");t>-1&&(e=e.substring(0,t));var a=e.split("/");return console.log(a),(a=a.reverse()).length>0?a[0]:"other"}(),imageDefaultWidth:670,imageList:[],show_image_url:null,cover_index:0,page_order:"-/-",batch_order:"-/-"},a.page_type=-1,a.minWidth=400,a.maxWidth=1600,a.angle=0,a.q_angle=0,a.rotate_image_name=null,a.anscard_id=null,a.layer={rate_x:0,rate_y:0,rate_w:1,rate_h:1},"fatal"===a.state.tail_route?a.page_type=1:"absent"===a.state.tail_route?a.page_type=4:"objective"===a.state.tail_route?a.page_type=5:"student"===a.state.tail_route?a.page_type=2:"losing"===a.state.tail_route&&(a.page_type=6),console.log(e),console.log("==>: "+a.state.tail_route,a.page_type),a.onEnlargeClick=a.onEnlargeClick.bind(a),a.onLessClick=a.onLessClick.bind(a),a.onLeftRotateClick=a.onLeftRotateClick.bind(a),a.onRightRotateClick=a.onRightRotateClick.bind(a),a.onQuarterRotateClick=a.onQuarterRotateClick.bind(a),a.onGetLayout=a.onGetLayout.bind(a),a.onMainPicLoad=a.onMainPicLoad.bind(a),a.initImageList=a.initImageList.bind(a),a.getImageByAbnormalId=a.getImageByAbnormalId.bind(a),a.onSetAbnormalId=a.onSetAbnormalId.bind(a),a.getUrlFileName=a.getUrlFileName.bind(a),a.getReRegInfo=a.getReRegInfo.bind(a),a.getBatchOrder=a.getBatchOrder.bind(a),a.reRecognizedState=a.reRecognizedState.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=this;this.getImageByAbnormalId(),q.on("message-pic-rotate-1-end",function(t,a){console.log(a),e.rotate_image_name=a,e.setState({show_image_url:M.a.util.make_local_url("/"+a)},function(){B()("#pic_image").off(),B()("#pic_image").on("load",function(){e.onGetLayout()})})})}},{key:"componentWillUnmount",value:function(){q.removeAllListeners("message-pic-rotate-1-end"),this.setState=function(e,t){}}},{key:"getReRegInfo",value:function(){return{abnormal_id:this.state.abnormal_id,filename:this.rotate_image_name,anscard_id:this.anscard_id,layer:ee}}},{key:"reRecognizedState",value:function(e){this.setState({has_recognized:e})}},{key:"getImageByAbnormalId",value:function(){var e=this;if(this.page_type<6&&this.page_type>0){var t=M.a.util.make_local_url("/get_detail_data"),a={abnormal_id:this.state.abnormal_id,type:this.page_type};console.log(a),M.a.http.get(t,a,function(t){if(console.log("=========================="),console.log(t),"ERROR"!=t.type&&t.data){e.anscard_id=t.data.anscard_id;var a=t.data.scan_datas,n=t.data.be_done;e.setState({has_recognized:n}),a.length>1&&(-1!=a[0].page_num&&-1!=a[1].page_num?a.sort(function(e,t){return e.page_num-t.page_num}):a.sort(function(e,t){return e.id.localeCompare(t.id)}));for(var i=[],s=null,r=0;r<a.length;r++){var l={image_url:M.a.util.make_local_url("/"+M.a.util.get_image_name(a[r].source_image)),image_name:""+a[r].source_image,_id:a[r].id};"fatal"===e.state.tail_route&&1==n&&a[r].align_image&&(l={image_url:M.a.util.make_local_url("/"+M.a.util.get_image_name(a[r].align_image)),image_name:""+a[r].align_image,_id:a[r].id}),i.push(l),i[r]._id===e.state.abnormal_id&&(console.log(i[r]._id,e.state.abnormal_id),s=M.a.util.make_local_url("/"+M.a.util.get_image_name(i[r].image_url)),e.rotate_image_name=M.a.util.get_image_name(a[r].source_image)),q.send("message-pic-bak",e.rotate_image_name)}console.log(s),e.setState({imageList:i,show_image_url:s})}}),e.getBatchOrder()}else if(6==this.page_type){t=M.a.util.make_local_url("/get_losing_student");M.a.http.get(t,{student_id:this.state.abnormal_id},function(t){if(console.log("考试缺页"),console.log(t),t.data.length>0){for(var a=[],n=null,i=0;i<t.data.length;i++){var s=e.state.abnormal_id;i>0&&(s=s+"_"+i),a.push({image_url:M.a.util.make_local_url("/"+M.a.util.get_image_name(t.data[i].image)),image_name:""+t.data[i].image,_id:s}),0==i&&(n=a[0].image_url)}e.setState({imageList:a,show_image_url:n})}})}else if("normal"===this.state.tail_route){var n=this,i=M.a.util.make_local_url("/get_normal_student_list");M.a.http.get(i,{},function(e){if(console.log("正常列表1",e),"ERROR"!==e.type){for(var t=e.data,a=[],i=0;i<t.length;i++)t[i].student_id===n.state.student_id&&(a=t[i]);var s=[];console.log(a);var r=null;for(i=0;i<a.image_id_arr.length;i++){var l=a.image_id_arr[i].image;s.push({image_url:M.a.util.make_local_url("/"+M.a.util.get_image_name(l)),image_name:""+l,_id:a.image_id_arr[i].id}),0==i&&(r=s[0].image_url)}n.setState({imageList:s,show_image_url:r})}}),n.getBatchOrder()}}},{key:"getBatchOrder",value:function(){var e=this,t=M.a.util.make_local_url("/get_batch_order_by_abnormal_id");M.a.http.get(t,{abnormal_id:this.state.abnormal_id},function(t){"AJAX"===t.type&&e.setState({page_order:t.data.page_order,batch_order:t.data.batch_order})})}},{key:"onSetAbnormalId",value:function(){}},{key:"onEnlargeClick",value:function(){var e=this,t=this.state.imageDefaultWidth+20;t>this.maxWidth||this.setState({imageDefaultWidth:t},function(){e.onGetLayout()})}},{key:"onLessClick",value:function(){var e=this,t=this.state.imageDefaultWidth-20;t<this.minWidth||this.setState({imageDefaultWidth:t},function(){e.onGetLayout()})}},{key:"onLeftRotateClick",value:function(){this.angle+=1;var e=0==this.q_angle?this.getUrlFileName():"rotate_"+this.q_angle+"_"+this.getUrlFileName();e&&q.send("message-pic-rotate",{type:1,filename:e,angle:this.angle})}},{key:"onRightRotateClick",value:function(){this.angle-=1;var e=0==this.q_angle?this.getUrlFileName():"rotate_"+this.q_angle+"_"+this.getUrlFileName();e&&q.send("message-pic-rotate",{type:1,filename:e,angle:this.angle})}},{key:"onQuarterRotateClick",value:function(){this.q_angle+=90,360==this.q_angle&&(this.q_angle=0),this.angle=0;var e=this.getUrlFileName();e&&q.send("message-pic-rotate",{type:90,filename:e,angle:this.q_angle})}},{key:"getUrlFileName",value:function(){for(var e=0;e<this.state.imageList.length;e++)if(console.log(this.state.abnormal_id,this.state.imageList[e]._id),this.state.abnormal_id===this.state.imageList[e]._id)return M.a.util.get_image_name(this.state.imageList[e].image_name);return null}},{key:"onGetLayout",value:function(){var e=B()("#pic_image").width(),t=B()("#pic_image").height(),a=this.state.cover_index;if(a){a--,B()("#pic_layer").css({width:e+"px",height:t+"px"}),console.log(">>>>image   :"+e+", "+t);var n=M.a.util.make_local_url("/get_detail_data");M.a.http.get(n,{abnormal_id:this.state.abnormal_id,type:1},function(e){console.log(e),ae(B()("#pic_layer"),e.data.ret_pages[a])})}}},{key:"onMainPicLoad",value:function(e){if("objective"===this.state.tail_route||"student"===this.state.tail_route||"absent"===this.state.tail_route){var t=B()("#_picture_show").width();B()("#pic_image").width()>B()("#pic_image").height()&&this.setState({imageDefaultWidth:1.8*t})}}},{key:"componentWillReceiveProps",value:function(e){console.log("AbnormalPictureCorrect componentWillReceiveProps()"),console.log(e);var t=this;console.log("选择第张"+e.cover_index+"答题卡"),e.student_id!==this.state.student_id&&this.setState({student_id:e.student_id},function(){t.getImageByAbnormalId()}),e.cover_index<1&&this.setState({cover_index:0}),e.cover_index!==this.state.cover_index&&(B()("#pic_layer").empty(),e.cover_index>0&&(0==this.state.imageList.length?function(e){R.a.warning({title:"提示",content:e})}("请选择异常卷"):this.setState({cover_index:e.cover_index},function(){t.onGetLayout()}))),e.abnormal_id!==this.state.abnormal_id&&this.setState({abnormal_id:e.abnormal_id,const_abnormal_id:e.abnormal_id,has_recognized:!1},function(){t.angle=0,t.q_angle=0,t.getImageByAbnormalId()})}},{key:"imgItemClick",value:function(e,t,a){if(this.state.abnormal_id!=e._id){this.rotate_image_name=e.image_name;var n=this;this.setState({abnormal_id:e._id,show_image_url:e.image_url},function(){n.getBatchOrder()}),"function"==typeof this.props.onPagesSideClick&&"fatal"===this.state.tail_route&&this.props.onPagesSideClick(e._id)}}},{key:"onListPicLoad",value:function(){var e=B()(".view_pic").height(),t=B()(".view_pic").width();console.log(e,t),t>e?B()(".view_pic").css("width","100%"):B()(".view_pic").css("width","90px")}},{key:"initImageList",value:function(){for(var e=this.state.imageList,t=[],a=0;a<e.length;a++)t.push(i.a.createElement("div",{className:"single_pic_box",key:a+"image",style:{borderColor:this.state.abnormal_id==e[a]._id?"#3d6ed8":"#ccc"},onClick:this.imgItemClick.bind(this,e[a],a)},i.a.createElement("img",{src:e[a].image_url,className:"view_pic",onLoad:this.onListPicLoad.bind(this)})));return t}},{key:"clearPictures",value:function(){this.setState({imageList:[],show_image_url:null})}},{key:"render",value:function(){return console.log("render=>"+this.state.abnormal_id),i.a.createElement("div",{className:"_picture_correct_com"},i.a.createElement("div",{className:"_picture_title"},i.a.createElement("div",{className:"show_tip"},6!==this.page_type?i.a.createElement("span",null,"试卷位置：第 ",this.state.batch_order," 批、 第 ",this.state.page_order," 张试卷"):i.a.createElement("div",null)),i.a.createElement("div",{className:"op_btns"},i.a.createElement("img",{src:J.a,onClick:this.onLessClick}),i.a.createElement("img",{src:T.a,onClick:this.onEnlargeClick}),"fatal"!==this.state.tail_route||this.state.abnormal_id!==this.state.const_abnormal_id||this.state.has_recognized?i.a.createElement("span",null):i.a.createElement("span",null,i.a.createElement("img",{src:V.a,onClick:this.onLeftRotateClick}),i.a.createElement("img",{src:X.a,onClick:this.onRightRotateClick}),i.a.createElement("img",{src:K.a,onClick:this.onQuarterRotateClick})))),i.a.createElement("div",{className:"_picture_box"},i.a.createElement("div",{className:"_picture_show",id:"_picture_show"},i.a.createElement("img",{className:"pic_image",src:this.state.show_image_url,style:{width:this.state.imageDefaultWidth},onLoad:this.onMainPicLoad,id:"pic_image"}),i.a.createElement("div",{className:"pic_grid",id:"pic_grid"}),i.a.createElement("div",{className:"pic_layer",id:"pic_layer",style:{width:this.state.imageDefaultWidth}}))),i.a.createElement("div",{className:"_picture_list"},this.initImageList()))}}]),t}(n.Component),ie=a(38),se=a.n(ie),re=(a(364),window.require("electron")),le=(re.remote,re.ipcRenderer,function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.state={items:e.items},a.items=a.items.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){this.setState({items:e.items})}},{key:"items",value:function(){console.log(this.state.items);var e=[],t=1;if(0==this.state.items.length)return e.push(i.a.createElement("div",{className:"options_item",key:"none"},"未发现客观题")),e;var a=!0,n=!1,s=void 0;try{for(var r,l=se()(this.state.items);!(a=(r=l.next()).done);a=!0){for(var o=r.value,c=o.answer_arr,d=o.options_arr,m=o.item_num+". ",u=0;u<c.length;u++){c.length>1&&(m+="("+u+").");var _=this.answer_map(c[u],d[u]);m+=""===_?"未作答":_,m+=" ，"}e.push(i.a.createElement("div",{className:"options_item",key:o.item_id+t},m)),t++}}catch(e){n=!0,s=e}finally{try{!a&&l.return&&l.return()}finally{if(n)throw s}}return e}},{key:"answer_map",value:function(e,t){for(var a="",n=0;n<e.length;n++)console.log(e[n]),t[e[n]]&&(a+=t[e[n]]);return a}},{key:"renderBtnList",value:function(e,t,a,n){var s=[];for(var r in e){var l=void 0;l=t.indexOf(parseInt(r))>-1?i.a.createElement("button",{className:"btn_single btn_clicked  ant-btn ",key:r},e[r]):i.a.createElement("button",{className:"btn_single ant-btn",key:r},e[r]),s.push(l)}var o=void 0;return o=t.indexOf(-1)>-1?i.a.createElement("button",{className:"btn_single ant-btn btn_clicked",style:{width:55,marginRight:0},key:"none",clicked:1},"未作答"):i.a.createElement("button",{className:"btn_single ant-btn",style:{width:55,marginRight:0},key:"none",clicked:0},"未作答"),s.push(o),s}},{key:"render",value:function(){return i.a.createElement("div",{className:"objective_items"},this.items())}}]),t}(n.Component)),oe=(a(362),function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.state={title:e.title},a}return k()(t,e),b()(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({title:e.title})}},{key:"render",value:function(){return i.a.createElement("div",{className:"modal_title"},i.a.createElement("img",{src:w.a,className:"modal_logo"}),i.a.createElement("span",{className:"modal_content"},this.state.title))}}]),t}(n.Component)),ce=(a(360),j.a.Search),de=(window.require("electron").ipcRenderer,P.a.Group);function me(){B()("#delete_normal_student").hide(),document.onmouseup=null,console.log("on_document_mouseup")}for(var ue=function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.onRadioChange=function(e){console.log("radio checked",e.target.value),a.setState({radio_key:e.target.value})},a.state={pic_normal_id:null,student_id:null,loading:!1,scan_datas:[],normal_list:[],normal_list_bak:[],items:[],radio_key:1,visible:!1,row_index:-1,table_height:550},a.select_item=null,a.onChangeStudent=a.onChangeStudent.bind(a),a.changeLayout=a.changeLayout.bind(a),a.onChangeUserName=a.onChangeUserName.bind(a),a.onSearchUserName=a.onSearchUserName.bind(a),a.onFuzzyQuery=a.onFuzzyQuery.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=this;this.updateNormalStudents(),this.changeLayout(),B()(window).resize(this.changeLayout),B()("#delete_normal_student").click(function(){var t=M.a.util.make_local_url("/delete_losing_student");e.state.student_id&&M.a.http.post(t,{student_id:e.state.student_id},function(t){console.log(t),"AJAX"===t.type?(console.log("删除成功"+e.state.student_id),e.updateNormalStudents()):console.log("删除fail0"+e.state.student_id)})})}},{key:"componentWillReceiveProps",value:function(e){this.updateNormalStudents()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"changeLayout",value:function(){var e=B()(window).width()-594,t=B()(window).height()-155;B()("#pic_box").outerWidth(e),B()("#table_body").height(t),B()("#item_div").height(t-5),this.setState({table_height:t-40})}},{key:"updateNormalStudents",value:function(){var e=this,t=M.a.util.make_local_url("/get_normal_student_list");M.a.http.get(t,{},function(t){if(console.log("正常列表",t),"ERROR"!==t.type){var a=t.data;if(a.length>0){e.select_item=a[0];var n=a[0].ids&&a[0].ids.length>0?a[0].ids[0]:null;console.log(n),e.setState({normal_list:a,normal_list_bak:a,pic_normal_id:n,row_index:0,student_id:a[0].student_id}),e.onChangeStudent(a[0],0)}else e.setState({normal_list:a,row_index:-1,items:[]})}})}},{key:"onChangeStudent",value:function(e,t){this.select_item=e;var a=e.ids.length>0?e.ids[0]:"";this.setState({pic_normal_id:a,row_index:t,student_id:e.student_id});var n=this,i=[],s=M.a.util.make_local_url("/get_recognize_result");console.log(G()(e.ids)),M.a.http.get(s,{abnormal_ids:G()(e.ids)},function(e){"ERROR"!==e.type&&((i=e.data).sort(function(e,t){return e.item_num-t.item_num}),n.setState({items:i}),console.log(i))})}},{key:"onHandlePagesSideClick",value:function(e){this.setState({pic_normal_id:e})}},{key:"changeAbnormalPaper",value:function(){this.setState({visible:!0})}},{key:"certainClick",value:function(){var e=this,t=1;1===this.state.radio_key?t=1:2===this.state.radio_key?t=4:3===this.state.radio_key?t=5:4===this.state.radio_key&&(t=2);var a=M.a.util.make_local_url("/sign_abnormal");console.log(this.select_item),M.a.http.post(a,{abnormal_id:this.state.pic_normal_id,type:t,ids:G()(this.select_item.ids)},function(t){"AJAX"===t.type&&(e.updateNormalStudents(),e.refs.pic_com.clearPictures(),console.log("设置为异常卡成功"))}),this.setState({visible:!1})}},{key:"handleCancel",value:function(){this.setState({visible:!1})}},{key:"onChangeUserName",value:function(e){console.log(e.target.value),this.onFuzzyQuery(e.target.value)}},{key:"onSearchUserName",value:function(e){console.log(e),this.onFuzzyQuery(context)}},{key:"onFuzzyQuery",value:function(e){for(var t=this.state.normal_list_bak.length,a=[],n=new RegExp(e),i=0;i<t;i++){var s=this.state.normal_list_bak[i].real_name,r=this.state.normal_list_bak[i].exam_number;(s.match(n)||r.match(n))&&a.push(this.state.normal_list_bak[i])}this.setState({normal_list:a})}},{key:"renderStudentTable",value:function(){var e=this,t=this;return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("table",{className:"student_table"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("td",{style:{width:100}},"考生"),i.a.createElement("td",{style:{width:110}},"考号"),i.a.createElement("td",{style:{width:110}},"上传状态"))))),i.a.createElement("div",null,i.a.createElement(Z.b,{width:250,height:this.state.table_height,rowHeight:30,rowCount:this.state.normal_list.length,rowGetter:function(t){var a=t.index;return e.state.normal_list[a]},onRowRightClick:function(e){var a=e.event,n=e.index,i=e.rowData;console.log(a.pageX,a.pageY,n,i),t.onChangeStudent(i,n),B()("#delete_normal_student").css({left:a.pageX+"px",top:a.pageY+"px",display:"block"}),document.onmouseup=me},onRowClick:function(e){e.event;var a=e.index,n=e.rowData;t.onChangeStudent(n,a)}},i.a.createElement(Z.a,{label:"Name",width:250,dataKey:"uploaded",style:{textAlign:"center",margin:0},cellRenderer:function(e){var a=e.rowData,n=(e.rowIndex,a.uploaded?"完成":"待上传"),s=a.student_id===t.state.student_id?"#eaf0fb":"#fff";return i.a.createElement("div",{className:"row_stu",style:{backgroundColor:s}},i.a.createElement("span",{style:{width:75}},a.real_name),i.a.createElement("span",{style:{width:80}},a.exam_number),i.a.createElement("span",{style:{width:90,color:a.uploaded?"#13D469":"#666"}},n))}})),i.a.createElement("div",{className:"theme-menu",id:"delete_normal_student"},"删除该学生试卷")))}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{id:"page",className:"page"},i.a.createElement("div",{className:"table_box",id:"table_box"},i.a.createElement("div",{className:"table_title"},"正常试卷列表(",this.state.normal_list_bak.length,"人)"),i.a.createElement("div",null,i.a.createElement(ce,{placeholder:"请输入姓名或者学号搜索",onSearch:this.onSearchUserName,onChange:this.onChangeUserName,style:{width:250}})),this.renderStudentTable()),i.a.createElement("div",{className:"pic_box",id:"pic_box"},i.a.createElement(ne,{abnormal_id:this.state.pic_normal_id,student_id:this.state.student_id,ref:"pic_com",onPagesSideClick:this.onHandlePagesSideClick.bind(this)})),i.a.createElement("div",{className:"item_box"},i.a.createElement("div",{className:"table_title"},"客观题识别结果"),i.a.createElement("div",{id:"item_div"},i.a.createElement(le,{items:this.state.items})),i.a.createElement("div",{className:"btn_div"},i.a.createElement(L.a,{type:"primary",className:"error_btn",disabled:!(this.state.normal_list.length>0),onClick:this.changeAbnormalPaper.bind(this)},"设为异常答题卡")))),i.a.createElement(R.a,{title:i.a.createElement(oe,{title:"设置为异常答题卡"}),visible:this.state.visible,maskClosable:!1,onCancel:this.handleCancel.bind(this),footer:null},i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement(de,{onChange:this.onRadioChange,value:this.state.radio_key},i.a.createElement(P.a,{value:1,style:{marginLeft:15,marginTop:8,marginRight:30,marginBottom:16}},"试卷识别异常"),i.a.createElement(P.a,{value:2,style:{marginTop:8,marginRight:30,marginBottom:16}},"缺考识别异常"),i.a.createElement(P.a,{value:3,style:{marginTop:8,marginRight:30,marginBottom:16}},"客观题识别异常"),i.a.createElement(P.a,{value:4,style:{marginLeft:15,marginTop:8,marginRight:30,marginBottom:56}},"考生识别异常"))),i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(L.a,{style:{width:100},type:"primary",onClick:this.certainClick.bind(this)},"确定")))))}}]),t}(n.Component),_e=(a(87),a(14)),he=(a(356),function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return console.log("constructor"),a.htmlResize=a.htmlResize.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=this;this.htmlResize(),B()(window).resize(function(){e.htmlResize()})}},{key:"htmlResize",value:function(){var e=B()(window).height();B()("#_home_html").css({height:e-48+"px"}),B()("#icon_tip").css({marginTop:(e-160)/2+"px"})}},{key:"render",value:function(){return i.a.createElement("div",{className:"_home_html",id:"_home_html"},i.a.createElement("div",{id:"icon_tip",className:"icon_tip"},i.a.createElement(_e.a,{type:"smile",theme:"twoTone",twoToneColor:"#2d6ed8",style:{fontSize:50}}),i.a.createElement("span",null,"暂时没有需要处理的异常哦！")))}}]),t}(n.Component)),ge=(a(354),a(188),a(173)),pe=(a(230),a(166)),be=a(20),ve=a.n(be),fe=a(28),ye=a.n(fe),ke=a(7),Ee=a.n(ke),we=(a(227),a(136)),Ce=(a(226),a(137)),xe=a(8),Ne=a.n(xe),Se=(a(342),a(316)),Ie=a(176),Ae=a.n(Ie),De=Ce.a.Panel,Re=window.require("electron"),Le=(Re.remote,Re.ipcRenderer),ze=[],Ge=0;Ge<5e3;Ge++)ze.push({be_done:!0,exam_number:"011212-"+Ge,id:"xxxxx"+Ge,real_name:"Tvisl"});var Pe=["x","fatal_error","absent_error","objective_error","number_error","missing_error"],je=["x","试卷识别异常","缺考异常","客观题异常","考生识别异常","试卷缺页异常"],Ze={fatal_error:"fatal",absent_error:"absent",number_error:"student",objective_error:"objective",missing_error:"losing"},Me=function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.onChange=function(e){var t=a;a.setState({activeKey:e},function(){t.onSkipNext("first")}),console.log("xxxxxxxxxxxxx")},a.state={abnormal_id:a.props.abnormal_id,exception_data:{},activeKey:null,panelBoxHeight:375},a.tail_route=M.a.util.get_tail_route(window.location.href),console.log("AbnormalSiderBar ==> ",e),a.onUpdateSiderBar=a.onUpdateSiderBar.bind(a),a.onSkipNext=a.onSkipNext.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.onUpdateSiderBar("init");var e=this;Le.on("message-update-siderbar-list",function(t,a){e.onUpdateSiderBar("init")})}},{key:"componentWillUnmount",value:function(){Le.removeAllListeners("message-update-siderbar-list"),this.setState=function(e,t){}}},{key:"onIgnoreAllClick",value:function(e){e.stopPropagation();var t=M.a.util.make_local_url("/ignore_objective"),a=this;M.a.http.post(t,{},function(){console.log("忽略成功"),a.onUpdateSiderBar()})}},{key:"onSkipNext",value:function(e){var t=Pe[this.state.activeKey];if(t){var a=this.state.exception_data[t].scan_datas,n=null;if("next"==e){for(var i=!0,s=0;s<a.length;s++)this.state.abnormal_id===a[s].id&&s<a.length-1&&(n=a[s+1].id),a[s].be_done||(i=!1);"missing_error"==t&&(0==a.length?i=!0:n=a[0].id,console.log("over>>"+i)),i&&(we.a.config({duration:2,maxCount:2,top:250}),we.a.info(je[this.state.activeKey]+" 已处理完毕"))}else"first"==e&&a.length>0&&(n=a[0].id);n&&(console.log("跳转到下一个未处理的选项"),console.log(n),window.location.href="#/abnormal/"+n+"/"+Ze[t])}}},{key:"render_panel",value:function(e,t,a,n){var s=this.state.exception_data[e];if(!s)return i.a.createElement(De,{header:t+" (0)",key:n},i.a.createElement("div",{className:"panel_box"}));var r,l=s.all_count,o=s.scan_datas,c=s.deal_count,d="("+l+")",m=this.state.abnormal_id;return l?(c>=0&&(d=i.a.createElement("span",null,"(",i.a.createElement("span",{className:"deal_span"},c),"/",i.a.createElement("span",{className:"all_span"},l),")")),r="objective"==a?i.a.createElement("span",null,t," ",d,i.a.createElement("a",{className:"ignore_all",onClick:this.onIgnoreAllClick.bind(this)},"批量忽略")):i.a.createElement("span",null,t," ",d),i.a.createElement(De,{header:r,key:n},i.a.createElement("div",{className:"panel_box",id:"panel_box"},i.a.createElement(Z.b,{width:275,height:375,rowHeight:30,rowCount:o.length,rowGetter:function(e){var t=e.index;return o[t]}},i.a.createElement(Z.a,{label:"Name",width:276,dataKey:"",style:{margin:0},cellRenderer:function(e){var t=e.rowData,n=e.rowIndex,s=t.id,r=t.be_done,l=t.exam_number,o=t.real_name,c="/abnormal/"+s+"/"+a,d=Ne()("abnormal_link",Ee()({},"active",m===s));return i.a.createElement("div",{key:"num_"+n,className:d},r?i.a.createElement("img",{className:"done",src:Ae.a}):null,i.a.createElement(Se.a,{to:{pathname:c,query:{exam_number:l,be_done:r}}},n+1,o?"-"+o:"",l?"-"+l:""))}}))))):i.a.createElement(De,{header:t+" (0)",key:n},i.a.createElement("div",{className:"panel_box"}))}},{key:"componentWillReceiveProps",value:function(e){this.setState({abnormal_id:e.abnormal_id,activeKey:e.activeKey})}},{key:"onUpdateSiderBar",value:function(e){var t=this,a=M.a.util.make_local_url("/get_exception_info");M.a.http.get(a,{},function(a){"AJAX"==a.type&&(console.log("SideBar列表更新"),console.log(a.data),t.setState({exception_data:a.data},function(){"init"!==e&&"fatal"!=t.tail_route&&t.onSkipNext("next")}))})}},{key:"downloadAbnormalTable",value:function(){var e=M.a.util.make_local_url("/get_all_students"),t=this;ye()(ve.a.mark(function a(){var n,i,s,r,l,o,c,d,m,u,_,h,g,p,b,v,f,y,k,E;return ve.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,M.a.http.get(e,{});case 2:return n=a.sent,a.next=5,n.json();case 5:if("ERROR"!==(i=a.sent).type){a.next=8;break}return a.abrupt("return");case 8:for(s=i.data.students,console.log(s),r={},l=0;l<s.length;l++)r[s[l].exam_number]=s[l];console.log(r),console.log(t.state.exception_data),o={fatal_error:"试卷识别异常",number_error:"学号异常",muti_error:"重复异常",absent_error:"缺考异常",objective_error:"客观题异常",missing_error:"缺页异常"},c=["fatal_error","absent_error","objective_error","number_error"],d=M.a.util.get_ini("exam_info"),m=["考试名称","学科","年级","班级","学生姓名","考号","异常类型"],u=[],l=0;case 20:if(!(l<c.length)){a.next=48;break}for(_=t.state.exception_data[c[l]],h=_.scan_datas,(g=[]).push(m),p=!0,b=!1,v=void 0,a.prev=28,f=se()(h);!(p=(y=f.next()).done);p=!0)k=y.value,(E=[]).push(d.exam_name?d.exam_name:"-/-"),E.push(d.subject_name?d.subject_name:"-/-"),E.push(d.school_name?d.school_name:"-/-"),r[k.exam_number]?E.push(r[k.exam_number].class_name):E.push("-/-"),E.push(k.real_name?k.real_name:"-/-"),E.push(k.exam_number?k.exam_number:"-/-"),E.push(o[c[l]]),g.push(E);a.next=36;break;case 32:a.prev=32,a.t0=a.catch(28),b=!0,v=a.t0;case 36:a.prev=36,a.prev=37,!p&&f.return&&f.return();case 39:if(a.prev=39,!b){a.next=42;break}throw v;case 42:return a.finish(39);case 43:return a.finish(36);case 44:u.push({name:o[c[l]],data:g});case 45:l++,a.next=20;break;case 48:console.log(u),Le.send("message-download-abnormal-excel",u);case 50:case"end":return a.stop()}},a,this,[[28,32,36,44],[37,,39,43]])}))()}},{key:"render",value:function(){return i.a.createElement("div",{className:"_abnormal_nav_com"},i.a.createElement("div",{className:"side_bar_title"},i.a.createElement("span",null,"异常列表"),i.a.createElement("label",{onClick:this.downloadAbnormalTable.bind(this)},"下载异常列表")),i.a.createElement(Ce.a,{activeKey:[this.state.activeKey],onChange:this.onChange,accordion:!0},this.render_panel("fatal_error","试卷识别异常","fatal","1"),this.render_panel("absent_error","缺考识别异常","absent","2"),this.render_panel("number_error","考生识别异常","student","4"),this.render_panel("objective_error","客观题异常","objective","3"),this.render_panel("missing_error","试卷缺页异常","losing","5")))}}]),t}(n.Component),We={resize:function(){var e=B()(window).height()-46,t=e-14;B()("#page").outerHeight(e),B()("#left").outerHeight(t),B()("#middle").outerHeight(t),B()("#right").outerHeight(t),B()("#abnormal_items").css("max-height",t-260),B()("#normal_items").css("max-height",t-260),B()("#objective_item_box")&&B()("#objective_item_box").css({"max-height":t-150})}},Be=window.require("electron"),Ue=Be.ipcRenderer,Te=(Be.remote,function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.handleSearch=function(e){var t=[],n=new RegExp(e);a.students.forEach(function(e){var a=e.exam_number,i=e.real_name+"/"+a;i.match(n)&&t.push(i)}),a.setState({dataSource:t})},a.onChange=function(e){var t=a;a.setState({student:e},function(){t.students.forEach(function(a){var n=a.exam_number,i=a.real_name;e===i+"/"+n&&(t.klx_student_id=a.student_id,console.log(t.klx_student_id))})})},a.students=[],a.klx_student_id=null,a.state={abnormal_id:a.props.match.params.abnormal_id,pic_abnormal_id:a.props.match.params.abnormal_id,dataSource:[],content_min_height:0,student:"",has_be_done:0,student_id:"",exam_number:""},a.changeState=a.changeState.bind(a),a.updateStudents=a.updateStudents.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=this;this.updateStudents(),Ue.on("message-update-exception-sutdents",function(t,a){console.log("message-update-exception-sutdents"),e.updateStudents()}),this.setState({content_min_height:window.innerHeight-36-16}),We.resize(),B()(window).resize(We.resize)}},{key:"updateStudents",value:function(){console.log("======================");var e=M.a.util.make_local_url("/get_all_students"),t=this;M.a.http.get(e,{},function(e){console.log(e),"ERROR"!==e.type&&(t.students=e.data.students,t.updateDetailData())})}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"removeClick",value:function(){var e=M.a.util.make_local_url("/delete_abnormal"),t={abnormal_id:this.state.abnormal_id},a=this;M.a.http.post(e,t,function(e){"AJAX"==e.type&&(a.refs.sider_bar.onUpdateSiderBar(),a.refs.pic_com.clearPictures(),a.klx_student_id=null,a.setState({student:""}),console.log(a.state.abnormal_id,"remove"))})}},{key:"certainClick",value:function(){var e=this,t=this.klx_student_id;if(this.klx_student_id){var a=M.a.util.make_local_url("/complete_match"),n={abnormal_id:this.state.abnormal_id,student_id:this.klx_student_id};M.a.http.post(a,n,function(a){"AJAX"==a.type&&(e.refs.sider_bar.onUpdateSiderBar(),console.log(e.state.abnormal_id,"complete_match"),e.setState({has_be_done:1,student_id:t}))})}}},{key:"updateDetailData",value:function(){var e=this,t=M.a.util.make_local_url("/get_detail_data");console.log(this.state.abnormal_id),ye()(ve.a.mark(function a(){var n,i,s,r,l,o,c,d,m;return ve.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,M.a.http.get(t,{abnormal_id:e.state.abnormal_id,type:2});case 2:return n=a.sent,a.next=5,n.json();case 5:if(i=a.sent,console.log("考生考号识别 详细数据"),console.log(i),"AJAX"!==i.type){a.next=26;break}s=!1,r=0;case 11:if(!(r<e.students.length)){a.next=25;break}if(l=e.students[r],i.data.student_id!==l.student_id){a.next=22;break}return e.klx_student_id=l.student_id,o=l.exam_number,c=l.real_name,d=c+"/"+o,m=!0===i.data.be_done?1:0,e.setState({student:d,has_be_done:m,exam_number:i.data.student_number}),s=!0,a.abrupt("break",25);case 22:r++,a.next=11;break;case 25:s||(e.klx_student_id=null,e.setState({student:"",has_be_done:0}));case 26:case"end":return a.stop()}},a,this)}))()}},{key:"componentWillReceiveProps",value:function(e){console.log(this.state.abnormal_id+window.location.href);var t=this;this.setState({abnormal_id:e.match.params.abnormal_id,pic_abnormal_id:e.match.params.abnormal_id},function(){t.updateDetailData()})}},{key:"onHandlePagesSideClick",value:function(e){}},{key:"checkAgainClick",value:function(){this.setState({has_be_done:0})}},{key:"changeState",value:function(){return this.state.has_be_done?i.a.createElement("div",null,i.a.createElement("div",{className:"search_student"},i.a.createElement("span",null,"考生:"),i.a.createElement("span",null,this.state.student)),i.a.createElement("div",{className:"op_btns"},i.a.createElement(L.a,{onClick:this.checkAgainClick.bind(this),type:"primary",style:{width:110}},"重新匹配"))):i.a.createElement("div",null,i.a.createElement("div",{className:"search_student"},i.a.createElement("span",null,"考生:"),i.a.createElement(pe.a,{style:{width:200},dataSource:this.state.dataSource,placeholder:"输入学生姓名或学号",onSelect:this.onSelect,onSearch:this.handleSearch,value:this.state.student,onChange:this.onChange},i.a.createElement(j.a,{suffix:i.a.createElement(_e.a,{type:"search",className:"certain-category-icon"})}))),i.a.createElement("div",{className:"op_btns"},i.a.createElement(ge.a,{title:"确定删除该试卷？ ",onConfirm:this.removeClick.bind(this),okText:"确定",cancelText:"取消"},i.a.createElement(L.a,{type:"primary",ghost:!0},"删除")),i.a.createElement(L.a,{onClick:this.certainClick.bind(this),type:"primary"},"完成匹配")))}},{key:"render",value:function(){this.state.content_min_height;return console.log(this.state.abnormal_id),i.a.createElement("div",null,i.a.createElement("div",{className:"page",id:"page"},i.a.createElement("div",{className:"page_left",id:"left"},i.a.createElement(Me,{abnormal_id:this.state.abnormal_id,ref:"sider_bar",activeKey:"4"})),i.a.createElement("div",{className:"page_middle",id:"middle"},i.a.createElement(ne,{abnormal_id:this.state.pic_abnormal_id,ref:"pic_com"})),i.a.createElement("div",{className:"page_right",id:"right"},i.a.createElement("div",{className:"assign_result"},i.a.createElement("div",{className:"title"},"提示"),i.a.createElement("div",{className:"tips"},i.a.createElement("div",{className:"t"},"1.若找不到考号，请查看考生卷面书写的中文姓名或数字考号判定是否错涂/漏涂，并人工通过搜索匹配进行关联，完成关联后保存。若仍找不到考生，请打开http://www.17zuoye.com添加考生后，返回客户端，并在右上角▽工具栏中点击更新考生名单。"),i.a.createElement("div",{className:"t"},"2.若考号重复，请查看考生卷面书写的中文姓名或数字考号判定是否错涂/漏涂，并人工通过搜索匹配进行关联，完成关联后保存。若为重复试卷，请直接删除。")),this.changeState()))))}}]),t}(n.Component)),He=function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.state={abnormal_id:a.props.match.params.abnormal_id,pic_abnormal_id:a.props.match.params.abnormal_id,dataSource:[],content_min_height:0,absent_state:"未处理"},a.be_done=!1,a.removeClick=a.removeClick.bind(a),a.missingClick=a.missingClick.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.setState({content_min_height:window.innerHeight-36-16}),this.updateDetailData(),We.resize(),B()(window).resize(We.resize)}},{key:"updateDetailData",value:function(){var e=this,t=M.a.util.make_local_url("/get_detail_data");ye()(ve.a.mark(function a(){var n,i;return ve.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,M.a.http.get(t,{abnormal_id:e.state.abnormal_id,type:4});case 2:return n=a.sent,a.next=5,n.json();case 5:"AJAX"===(i=a.sent).type&&(e.setState({scan_datas:i.data.scan_datas,ret_pages:i.data.ret_pages}),console.log("获取详细数据"),console.log(i.data),e.be_done=i.data.be_done,e.be_done?1==i.data.is_student_absent?e.setState({absent_state:"缺考"}):2==i.data.is_student_absent&&e.setState({absent_state:"未缺考"}):e.setState({absent_state:"未处理"}));case 7:case"end":return a.stop()}},a,this)}))()}},{key:"removeClick",value:function(){var e=M.a.util.make_local_url("/certain_absent"),t={abnormal_id:this.state.abnormal_id,type:2},a=this;M.a.http.post(e,t,function(e){console.log(e),"AJAX"==e.type&&(a.refs.sider_bar.onUpdateSiderBar(),a.updateDetailData(),console.log(a.state.abnormal_id,"remove"))})}},{key:"missingClick",value:function(){var e=M.a.util.make_local_url("/certain_absent"),t={abnormal_id:this.state.abnormal_id,type:1},a=this;M.a.http.post(e,t,function(e){console.log(e),"AJAX"==e.type&&(a.refs.sider_bar.onUpdateSiderBar(),a.updateDetailData(),console.log(a.state.abnormal_id,"certain absent"))})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({abnormal_id:e.match.params.abnormal_id,pic_abnormal_id:e.match.params.abnormal_id},function(){t.updateDetailData()})}},{key:"render",value:function(){this.state.content_min_height;return i.a.createElement("div",null,i.a.createElement("div",{className:"page",id:"page"},i.a.createElement("div",{className:"page_left",id:"left"},i.a.createElement(Me,{abnormal_id:this.state.abnormal_id,ref:"sider_bar",activeKey:"2"})),i.a.createElement("div",{className:"page_middle",id:"middle"},i.a.createElement(ne,{abnormal_id:this.state.pic_abnormal_id}),i.a.createElement("div",{className:"absent_tip"},"缺考状态：",i.a.createElement("span",{style:{color:"缺考"==this.state.absent_state?"#FF796B":"#444"}},this.state.absent_state))),i.a.createElement("div",{className:"page_right",id:"right"},i.a.createElement("div",{className:"assign_result"},i.a.createElement("div",{className:"title"},"提示"),i.a.createElement("div",{className:"tips"},i.a.createElement("p",null,"1.若该券学生已作答，只是错误填涂了缺考标识，则“移出缺考”。"),i.a.createElement("p",null,"2.若确实为未作答卷，确认“缺考”。")),i.a.createElement("div",{className:"op_btns"},i.a.createElement(L.a,{onClick:this.removeClick,type:"primary",ghost:!0},"移除缺考"),i.a.createElement(L.a,{onClick:this.missingClick,type:"primary"},"确认缺考"))))))}}]),t}(n.Component),Je=function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return console.log(e),a.state={abnormal_id:a.props.match.params.abnormal_id,pic_abnormal_id:a.props.match.params.abnormal_id,dataSource:[],content_min_height:0},e.history.location.query&&(a.exam_num=e.history.location.query.exam_number),a.removeClick=a.removeClick.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){this.setState({content_min_height:window.innerHeight-36-16}),We.resize(),B()(window).resize(We.resize)}},{key:"removeClick",value:function(){var e=M.a.util.make_local_url("/delete_losing_student"),t=this;M.a.http.post(e,{student_id:this.state.abnormal_id},function(e){console.log(e),"AJAX"===e.type?(console.log("删除成功"),t.refs.sider_bar.onUpdateSiderBar(),t.refs.pic_com.clearPictures()):console.log("删除fail")})}},{key:"componentWillReceiveProps",value:function(e){e.history.location.query&&(this.exam_num=e.history.location.query.exam_number),this.setState({abnormal_id:e.match.params.abnormal_id,pic_abnormal_id:e.match.params.abnormal_id},function(){})}},{key:"render",value:function(){this.state.content_min_height;return i.a.createElement("div",null,i.a.createElement("div",{className:"page",id:"page"},i.a.createElement("div",{className:"page_left",id:"left"},i.a.createElement(Me,{abnormal_id:this.state.abnormal_id,activeKey:"5",ref:"sider_bar"})),i.a.createElement("div",{className:"page_middle",id:"middle"},i.a.createElement(ne,{abnormal_id:this.state.pic_abnormal_id,ref:"pic_com"})),i.a.createElement("div",{className:"page_right",id:"right"},i.a.createElement("div",{className:"assign_result"},i.a.createElement("div",{className:"title"},"提示"),i.a.createElement("div",{className:"tips"},i.a.createElement("p",null,"1.请确定该卷为本科考卷，若不是，请删除。"),i.a.createElement("p",null,"2.若不清晰，请找到本卷的卷纸后，重新扫描。")),i.a.createElement("div",{className:"op_btns"},i.a.createElement(L.a,{onClick:this.removeClick,type:"primary"},"删除"))))))}}]),t}(n.Component),Oe=P.a.Group,Ve=function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.onChange=function(e){a.setState({checked_type:e.target.value})},a.onAnsChange=function(e,t,n){var i=e.target.value;i=a.opts_input(i),n.answer_arr[t]=i,a.setState({items:a.state.items})},a.students=[],a.abnormal_ids=[],a.state={abnormal_id:a.props.match.params.abnormal_id,pic_abnormal_id:a.props.match.params.abnormal_id,content_min_height:0,checked_type:1,items:[],student:""},a.checkCancel=a.checkCancel.bind(a),a.getDetailData=a.getDetailData.bind(a),a.onCheckData=a.onCheckData.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=M.a.util.make_local_url("/get_all_students"),t=this;ye()(ve.a.mark(function a(){var n,i;return ve.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,M.a.http.get(e,{});case 2:return n=a.sent,a.next=5,n.json();case 5:if("ERROR"!==(i=a.sent).type){a.next=8;break}return a.abrupt("return");case 8:t.students=i.data.students,t.getDetailData(t.state.abnormal_id);case 10:case"end":return a.stop()}},a,this)}))(),this.setState({content_min_height:window.innerHeight-36-16}),We.resize(),B()(window).resize(We.resize)}},{key:"removeClick",value:function(){var e=M.a.util.make_local_url("/delete_abnormal"),t={abnormal_id:this.state.abnormal_id},a=this;M.a.http.post(e,t,function(e){"AJAX"==e.type&&(a.refs.sider_bar.onUpdateSiderBar(),console.log(a.state.abnormal_id,"remove"))})}},{key:"onCheckData",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,s=se()(e);!(t=(i=s.next()).done);t=!0){var r=i.value;if(!r.multiple_choice){var l=!0,o=!1,c=void 0;try{for(var d,m=se()(r.answer_arr);!(l=(d=m.next()).done);l=!0){if(d.value.length>1)return M.a.util.warning("第"+r.item_num+"为单选"),!1}}catch(e){o=!0,c=e}finally{try{!l&&m.return&&m.return()}finally{if(o)throw c}}}}}catch(e){a=!0,n=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw n}}return!0}},{key:"ignoreClick",value:function(){var e=M.a.util.make_local_url("/ignore_objective"),t=this;M.a.http.post(e,{abnormal_id:this.state.abnormal_id},function(){console.log("忽略成功"),t.refs.sider_bar.onUpdateSiderBar()})}},{key:"assignClick",value:function(){this.state.items;var e=this,t=M.a.util.make_local_url("/submit_object_data");console.log(this.state.items),ye()(ve.a.mark(function a(){var n,i,s,r,l,o;return ve.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:n=0;case 1:if(!(n<e.abnormal_ids.length)){a.next=15;break}for(i=[],s=0;s<e.state.items.length;s++)e.abnormal_ids[n]===e.state.items[s].abnormal_id&&(r=e.state.items[s],i.push(r));return l={abnormal_id:e.abnormal_ids[n],items:i},a.next=7,M.a.http.post(t,l);case 7:return o=a.sent,a.next=10,o.json();case 10:"AJAX"===a.sent.type&&n==e.abnormal_ids.length-1&&(e.refs.sider_bar.onUpdateSiderBar(),console.log("提交成功"));case 12:n++,a.next=1;break;case 15:case"end":return a.stop()}},a,this)}))()}},{key:"user_answer_display",value:function(e){return-1===e?"":String.fromCharCode("A".charCodeAt(0)+e)}},{key:"user_sys_answer",value:function(e){e=e.toUpperCase();var t="A".charCodeAt(0),a="Z".charCodeAt(0),n=e.charCodeAt(0);return n<t?-1:n>a?-1:e=n-t}},{key:"opts_output",value:function(e){var t=this,a="";return Array.isArray(e)&&e.forEach(function(e){a+=t.user_answer_display(e)}),a}},{key:"opts_input",value:function(e){var t=this,a=[];return(e=e.split("")).forEach(function(e){a.push(t.user_sys_answer(e))}),a.length>1&&-1!==a.indexOf(-1)&&a.splice(a.indexOf(-1),1),a}},{key:"checkCancel",value:function(e){var t=0,a=!0,n=!1,i=void 0;try{for(var s,r=se()(e);!(a=(s=r.next()).done);a=!0){"1"===s.value.getAttribute("clicked")&&t++}}catch(e){n=!0,i=e}finally{try{!a&&r.return&&r.return()}finally{if(n)throw i}}return t>1}},{key:"onBtnClicked",value:function(e,t,a,n){var i=e.answer_arr[t];if("0"===n.target.getAttribute("clicked")){i.indexOf(-1)>-1?i=[parseInt(a)]:(i.push(parseInt(a)),i.sort()),n.target.setAttribute("clicked","1"),n.target.classList.add("btn_clicked");var s=n.target.parentNode.childNodes.length-1;n.target.parentNode.childNodes[s].setAttribute("clicked","0"),n.target.parentNode.childNodes[s].classList.remove("btn_clicked")}else{var r=n.target.parentNode.childNodes,l=r.length-1;i.splice(i.indexOf(parseInt(a)),1),this.checkCancel(r)||(n.target.parentNode.childNodes[l].setAttribute("clicked","1"),n.target.parentNode.childNodes[l].classList.add("btn_clicked"),i=[-1]),n.target.setAttribute("clicked","0"),n.target.classList.remove("btn_clicked")}e.answer_arr[t]=i,this.setState({items:this.state.items})}},{key:"onNoAnsBtnClicked",value:function(e,t,a){if("0"===a.target.getAttribute("clicked")){a.target.setAttribute("clicked","1"),a.target.classList.add("btn_clicked");for(var n=a.target.parentNode.childNodes.length-1,i=0;i<n;i++)a.target.parentNode.childNodes[i].setAttribute("clicked","0"),a.target.parentNode.childNodes[i].classList.remove("btn_clicked");e.answer_arr[t]=[-1],this.setState({items:this.state.items})}}},{key:"items",value:function(e){var t=[],a={},n=!0,s=!1,r=void 0;try{for(var l,o=se()(this.state.items);!(n=(l=o.next()).done);n=!0){var c=l.value,d=c.is_suspected_abnormal,m=c.answer_arr,u=c.options_arr,_=[];if("abnormal"!==e||1===d){for(var h in u){var g=parseInt(c.item_num);a[c.item_num]?(g+=a[c.item_num],a[c.item_num]++):a[c.item_num]=1,console.log(g);var p=i.a.createElement("div",{className:"q",key:"ap_"+h},i.a.createElement("div",{className:"q_num"},g,"."),i.a.createElement("div",{className:"btn_box"},this.renderBtnList(u[h],m[h],h,c,d)));_.push(p)}t.push(i.a.createElement("div",{className:"item",key:c.item_id},_))}}}catch(e){s=!0,r=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw r}}return t}},{key:"renderBtnList",value:function(e,t,a,n,s){var r=[];for(var l in e){var o=void 0;t.indexOf(parseInt(l))>-1?1==s?o=i.a.createElement("button",{className:"btn_single btn_clicked  ant-btn red_btn",key:l,onClick:this.onBtnClicked.bind(this,n,a,l),clicked:1},e[l]):0==s&&(o=i.a.createElement("button",{className:"btn_single btn_clicked  ant-btn ",key:l,onClick:this.onBtnClicked.bind(this,n,a,l),clicked:1},e[l])):o=i.a.createElement("button",{className:"btn_single ant-btn",key:l,onClick:this.onBtnClicked.bind(this,n,a,l),clicked:0},e[l]),r.push(o)}var c=void 0;return c=t.indexOf(-1)>-1?1==s?i.a.createElement("button",{className:"btn_single ant-btn btn_clicked red_btn",style:{width:55,marginRight:0},key:"none",clicked:1,onClick:this.onNoAnsBtnClicked.bind(this,n,a)},"未作答"):i.a.createElement("button",{className:"btn_single ant-btn btn_clicked",style:{width:55,marginRight:0},key:"none",clicked:1,onClick:this.onNoAnsBtnClicked.bind(this,n,a)},"未作答"):i.a.createElement("button",{className:"btn_single ant-btn",style:{width:55,marginRight:0},key:"none",clicked:0,onClick:this.onNoAnsBtnClicked.bind(this,n,a)},"未作答"),r.push(c),r}},{key:"items_render",value:function(){var e=i.a.createElement("div",{className:"abnormal_items",id:"abnormal_items"},this.items("abnormal"));return 2===this.state.checked_type&&(e=i.a.createElement("div",{className:"normal_items",id:"normal_items"},this.items("normal"))),e}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({abnormal_id:e.match.params.abnormal_id,pic_abnormal_id:e.match.params.abnormal_id},function(){t.getDetailData(t.state.abnormal_id)})}},{key:"getDetailData",value:function(e){var t=this,a=M.a.util.make_local_url("/get_detail_data");M.a.http.get(a,{abnormal_id:t.state.abnormal_id,type:5},function(e){var a=e.data.scan_datas;console.log("获取客观题数据"),console.log(a);var n=[];t.abnormal_ids=[];for(var i=0;i<a.length;i++){for(var s=0;s<a[i].objective_items.length;s++){var r=a[i].objective_items[s];r.abnormal_id=a[i].id,n.push(r)}t.abnormal_ids.push(a[i].id)}n.sort(function(e,t){return parseFloat(e.item_num)-parseFloat(t.item_num)}),console.log(n),t.setState({items:n})})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"page",id:"page"},i.a.createElement("div",{className:"page_left",id:"left"},i.a.createElement(Me,{abnormal_id:this.state.abnormal_id,activeKey:"3",ref:"sider_bar"})),i.a.createElement("div",{className:"page_middle",id:"middle"},i.a.createElement(ne,{abnormal_id:this.state.pic_abnormal_id})),i.a.createElement("div",{className:"page_right",id:"right"},i.a.createElement("div",{className:"assign_result"},i.a.createElement("div",{className:"title",style:{height:21}},"提示："),i.a.createElement("div",{className:"tips"},i.a.createElement("p",null,"1.红框代表填涂有误的选项，请重新选择后，点击“提交”，处理下一位。"),i.a.createElement("p",null,"2.若考生未填涂/看不清考生的填涂，点击“忽略”，处理下一位。")),i.a.createElement("div",{className:"objectiveType_radioG"},i.a.createElement(Oe,{onChange:this.onChange,value:this.state.checked_type},i.a.createElement(P.a,{value:1},"只看异常题"),i.a.createElement(P.a,{value:2},"查看全部题目"))),this.items_render(),i.a.createElement("div",{className:"op_btns"},i.a.createElement(L.a,{onClick:this.ignoreClick.bind(this),type:"primary",ghost:!0},"忽略"),i.a.createElement(L.a,{onClick:this.assignClick.bind(this),type:"primary"},"提交"))))))}}]),t}(n.Component),Ye=(a(144),a(70)),Xe=window.require("electron"),Qe=Xe.ipcRenderer,Ke=(Xe.remote,Ye.a.Option);function Fe(e){R.a.warning({title:"提示",content:e})}var qe=function(e){function t(e){g()(this,t);var a=f()(this,(t.__proto__||_()(t)).call(this,e));return a.handleChange=function(e){console.log("----\x3e"+e),a.setState({selected:e})},a.students=[],a.recognize_result=null,a.state={abnormal_id:a.props.match.params.abnormal_id,pic_abnormal_id:a.props.match.params.abnormal_id,pic_selected_id:a.props.match.params.abnormal_id,objective_items:[],loading:!1,btn_name:"二次识别",exam_number:null,show_res:!1,has_submited:!1,selected:0,scan_datas:[],ret_pages:[]},a.be_done=!1,a.updateDetailData=a.updateDetailData.bind(a),a}return k()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=this;this.updateDetailData(),Qe.on("message-recognize-again-end",function(t,a){if(console.log("二次识别结果"),console.log(a),a){e.recognize_result=a;var n=a.data.records[0].ImageProcess.sStudentNumber;e.setState({loading:!1,exam_number:n,btn_name:"二次识别",show_res:!0,objective_items:a.objective_items}),console.log("二次识别完成")}else e.setState({loading:!1,exam_number:null,btn_name:"二次识别",show_res:!1}),console.log("二次识别失败"),Fe("二次识别失败")}),We.resize(),B()(window).resize(We.resize)}},{key:"componentWillUnmount",value:function(){Qe.removeAllListeners("message-recognize-again-end"),this.setState=function(e,t){}}},{key:"updateDetailData",value:function(){var e=this,t=M.a.util.make_local_url("/get_detail_data"),a=M.a.util.make_local_url("/get_recognize_result"),n=[];n.push(this.state.abnormal_id),console.log(this.state.abnormal_id),ye()(ve.a.mark(function i(){var s,r,l,o,c;return ve.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,M.a.http.get(t,{abnormal_id:e.state.abnormal_id,type:1});case 2:return s=i.sent,i.next=5,s.json();case 5:return"AJAX"===(r=i.sent).type&&(e.setState({scan_datas:r.data.scan_datas,ret_pages:r.data.ret_pages}),console.log("获取详细数据"),console.log(r.data),e.be_done=r.data.be_done),i.next=9,M.a.http.get(a,{abnormal_ids:G()(n)});case 9:return l=i.sent,i.next=12,l.json();case 12:"AJAX"===(o=i.sent).type&&(console.log(e.be_done),(c=o.data).sort(function(e,t){return e.item_num-t.item_num}),e.be_done?e.setState({exam_number:r.data.student_number,objective_items:c,show_res:!0,has_submited:!0}):e.setState({show_res:!1,has_submited:!1}),console.log("已经识别的结果"),console.log(o.data));case 14:case"end":return i.stop()}},i,this)}))()}},{key:"removeClick",value:function(){var e=M.a.util.make_local_url("/delete_abnormal"),t={abnormal_id:this.state.abnormal_id,error_type:1},a=this;M.a.http.post(e,t,function(e){"AJAX"==e.type&&(a.refs.sider_bar.onUpdateSiderBar(),a.refs.pic_com.clearPictures(),console.log(a.state.abnormal_id,"remove"))}),console.log("remove"),this.setState({selected:0})}},{key:"clearSubmitResultClick",value:function(){var e=this,t=M.a.util.make_local_url("/clear_re_recognize"),a={abnormal_id:this.state.abnormal_id},n=this;M.a.http.post(t,a,function(t){"AJAX"==t.type&&(n.refs.sider_bar.onUpdateSiderBar(),n.refs.pic_com.getImageByAbnormalId(),e.refs.pic_com.reRecognizedState(!1),n.setState({show_res:!1,has_submited:!1}))})}},{key:"recognitionClick",value:function(){if(this.state.selected){var e=this.refs.pic_com.getReRegInfo();console.log(e);var t={abnormal_id:e.abnormal_id,filename:e.filename,anscard_id:e.anscard_id,page_num:this.state.selected,rate_x:e.layer.rate_x,rate_y:e.layer.rate_y,rate_w:e.layer.rate_w,rate_h:e.layer.rate_h};t.filename?Qe.send("message-recognize-again",t):console.log("开始二次识别 newfilename is not exist"),this.setState({loading:!0,btn_name:"识别中"})}else Fe("请在右侧先选择当前图像所对应的页码")}},{key:"backRecognitionClick",value:function(){this.setState({show_res:!1,btn_name:"二次识别"})}},{key:"recognitionSubmitClick",value:function(){console.log("click"),this.setState({show_res:!0,has_submited:!0,btn_name:"二次识别"}),Qe.send("message-submit-recognize-result",this.recognize_result),this.refs.sider_bar.onUpdateSiderBar(),this.refs.pic_com.reRecognizedState(!0)}},{key:"user_answer_display",value:function(e){return-1===e?"":String.fromCharCode("A".charCodeAt(0)+e)}},{key:"opts_output",value:function(e){var t=this,a="";return Array.isArray(e)&&e.forEach(function(e){a+=t.user_answer_display(e)}),a}},{key:"componentWillReceiveProps",value:function(e){console.log("fatal componentWillReceiveProps"),console.log(e);var t=this;this.setState({abnormal_id:e.match.params.abnormal_id,pic_abnormal_id:e.match.params.abnormal_id,pic_selected_id:e.match.params.abnormal_id,selected:0,exam_number:null,loading:!1,btn_name:"二次识别",show_res:!1},function(){t.updateDetailData()})}},{key:"onHandlePagesSideClick",value:function(e){console.log(e),this.setState({pic_selected_id:e,selected:0})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"page",id:"page"},i.a.createElement("div",{className:"page_left",id:"left"},i.a.createElement(Me,{abnormal_id:this.state.abnormal_id,ref:"sider_bar",activeKey:"1"})),i.a.createElement("div",{className:"page_middle",id:"middle"},i.a.createElement(ne,{recognition:"true",onPagesSideClick:this.onHandlePagesSideClick.bind(this),ref:"pic_com",abnormal_id:this.state.pic_abnormal_id,cover_index:this.state.selected})),i.a.createElement("div",{className:"page_right",id:"right"},this.state.abnormal_id===this.state.pic_selected_id?i.a.createElement("div",{className:"assign_result"},this.state.show_res?i.a.createElement("div",null,i.a.createElement("div",{className:"title"},i.a.createElement("span",{style:{display:this.state.exam_number?"inline-block":"none"}},i.a.createElement(_e.a,{type:"check-circle",style:{color:"#3Ac41A",fontSize:16,marginRight:8}})),"识别出的学号：",this.state.exam_number?this.state.exam_number:"未识别出学号"),i.a.createElement("div",null,"客观题识别结果："),i.a.createElement("div",{id:"objective_item_box"},i.a.createElement(le,{items:this.state.objective_items})),i.a.createElement("div",{className:"op_btns"},this.state.has_submited?i.a.createElement("div",null,i.a.createElement(L.a,{onClick:this.clearSubmitResultClick.bind(this),type:"primary",style:{width:120}},"取消二次识别")):i.a.createElement("div",null,i.a.createElement(L.a,{onClick:this.backRecognitionClick.bind(this),type:"primary",ghost:!0},"取消"),i.a.createElement(L.a,{onClick:this.recognitionSubmitClick.bind(this),type:"primary"},"提交")))):i.a.createElement("div",null,i.a.createElement("div",{className:"title"},"操作步骤："),i.a.createElement("div",{className:"tips"},i.a.createElement("div",{className:"t"},i.a.createElement("span",{className:"label"},"1"),"请确定该卷为本科考卷，若不是，请删除。"),i.a.createElement("div",{className:"t"},i.a.createElement("span",{className:"label"},"2"),"若不清晰，请找到本卷的卷纸后，重新扫描。"),i.a.createElement("div",{className:"t"},i.a.createElement("span",{className:"label"},"3"),"请选择当前答题卡所属页数",i.a.createElement(Ye.a,{placeholder:"未选",style:{width:80,marginLeft:10},onChange:this.handleChange,value:this.state.selected>0?this.state.selected:"未选"},this.state.ret_pages.map(function(e,t){var a=t+1;return i.a.createElement(Ke,{value:a,key:"opt-"+a},a)}))),i.a.createElement("div",{className:"t"},i.a.createElement("span",{className:"label"},"4"),"按照网格线水平矫正答题卡，同时拖动鼠标，使答题卡和图片重合。")),i.a.createElement("div",{className:"op_btns"},i.a.createElement(L.a,{onClick:this.removeClick.bind(this),type:"primary",style:{width:90},ghost:!0},"删除"),i.a.createElement(L.a,{onClick:this.recognitionClick.bind(this),type:"primary",loading:this.state.loading,style:{width:90}},this.state.btn_name)))):i.a.createElement("div",{className:"assign_result"},i.a.createElement("div",{className:"title"},"提示："),i.a.createElement("div",{className:"tips"},i.a.createElement("div",{className:"t"},"1.反面未识别异常，您无需操作"))))))}}]),t}(n.Component),$e=Object(d.b)();document.onreadystatechange=function(){console.log(document.readyState),document.readyState},r.a.render(i.a.createElement(l.a,{history:$e},i.a.createElement(m.a,null,i.a.createElement(D,null,i.a.createElement(o.a,null,i.a.createElement(c.a,{path:"/home",component:he}),i.a.createElement(c.a,{path:"/abnormal/:abnormal_id/student",component:Te}),i.a.createElement(c.a,{path:"/abnormal/:abnormal_id/absent",component:He}),i.a.createElement(c.a,{path:"/abnormal/:abnormal_id/losing",component:Je}),i.a.createElement(c.a,{path:"/abnormal/:abnormal_id/objective",component:Ve}),i.a.createElement(c.a,{path:"/abnormal/:abnormal_id/fatal",component:qe}),i.a.createElement(c.a,{path:"/normal",component:ue}),i.a.createElement(c.a,{component:he}))))),document.getElementById("root_abnormal"))},245:function(e,t,a){e.exports=a.p+"./fonts/exam_grid.svg"},342:function(e,t){},354:function(e,t){},356:function(e,t){},360:function(e,t){},362:function(e,t){},364:function(e,t){},366:function(e,t){},378:function(e,t){},380:function(e,t){},384:function(e,t){},50:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjE0cHgiIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDE0IDE1IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTEgKDU3NDYyKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4NCiAgICA8dGl0bGU+5YWz6ZetPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IuWFs+mXrSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMDAwMDAwLCAxLjAwMDAwMCkiIGZpbGw9IiNGRkZGRkYiIGlkPSLmnIDlsI8iPg0KICAgICAgICAgICAgPHJlY3QgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMTA0MDgsIDYuMDEwNDA4KSByb3RhdGUoNDUuMDAwMDAwKSB0cmFuc2xhdGUoLTYuMDEwNDA4LCAtNi4wMTA0MDgpICIgeD0iLTAuOTg5NTkyMzYiIHk9IjQuNTEwNDA3NjQiIHdpZHRoPSIxNCIgaGVpZ2h0PSIzIj48L3JlY3Q+DQogICAgICAgICAgICA8cmVjdCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2LjAxMDQwOCwgNi4wMTA0MDgpIHJvdGF0ZSgxMzUuMDAwMDAwKSB0cmFuc2xhdGUoLTYuMDEwNDA4LCAtNi4wMTA0MDgpICIgeD0iLTAuOTg5NTkyMzYiIHk9IjQuNTEwNDA3NjQiIHdpZHRoPSIxNCIgaGVpZ2h0PSIzIj48L3JlY3Q+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4="},59:function(e,t,a){e.exports=a.p+"./fonts/sm_logo.svg"},78:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjE0cHgiIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDE0IDE1IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTEgKDU3NDYyKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4NCiAgICA8dGl0bGU+5pyA5bCP5YyWPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IuacgOWwj+WMliIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxyZWN0IGlkPSLmnIDlsI8iIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjYiIHdpZHRoPSIxNCIgaGVpZ2h0PSIzIj48L3JlY3Q+DQogICAgPC9nPg0KPC9zdmc+"},79:function(e,t,a){"use strict";var n=a(12),i=a.n(n),s=a(3),r=a.n(s),l=a(6),o=a.n(l),c=a(4),d=a.n(c),m=a(5),u=a.n(m),_=a(0),h=a.n(_),g=(a(380),function(e){function t(e){return r()(this,t),d()(this,(t.__proto__||i()(t)).call(this,e))}return u()(t,e),o()(t,[{key:"render",value:function(){return h.a.createElement("div",{className:"page_base_html"},this.props.children)}}]),t}(_.Component));t.a=g},9:function(e,t,a){"use strict";var n=a(3),i=a.n(n),s=a(6),r=a.n(s),l=a(21),o=a.n(l),c=(a(0),a(112),a(11)),d=a.n(c),m=a(46),u=a.n(m),_={};function h(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments[3],i=arguments[4],s=new Date,r={},l=a,c=t;r.method=e,r.credentials="include",r.headers={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json",Accept:"application/json; charset=utf-8"},l.t=s.getTime();var m=u.a.load("u_token"),_=u.a.load("u_user_id");if(m&&(r.headers.token=m,r.headers.uid=_),"post"===e)r.body=o()(l);else if("put"===e)r.body=o()(l);else{c=t+"?"+d.a.param(l)}function h(e){var t=e.status,a=[];if(t>=200&&t<300)return e;400!==t&&500!==t||a.push("我们正在努力解决问题"),401===t&&a.push("您尚未登录"),403===t&&a.push("你无权限访问"),404===t&&a.push("未发现所请求的资源"),403===t&&a.push("没有权限或访问的资源不属于此账号"),502===t&&a.push("服务正在升级，请稍后重试！"),"function"==typeof i&&i(t),a.push("("+e.statusText+")");var n=new Error;throw n.name=t,n.message=a.join("\n"),n.res=e,n}function g(e){"function"==typeof i&&i(500),e.name&&"Error"!==e.name&&e.name,console.log("Network Error: ",e.message)}if(!n)return fetch(c,r).then(h).catch(g);fetch(c,r).then(h).then(function(e){return e.json()}).then(function(e){n(e)}).catch(g)}_.http={get:function(e,t,a,n){return h("get",e,t,a,n)},post:function(e,t,a,n){return h("post",e,t,a,n)},put:function(e,t,a,n){return h("put",e,t,a,n)},_delete:function(e,t,a,n){return h("delete",e,t,a,n)}};var g=function(){function e(){i()(this,e);var t=null;try{(t=new WebSocket("ws://127.0.0.1:10080")).onopen=function(e){console.log("已经与服务器建立了连接\r\n当前连接状态："+this.readyState)},t.onerror=function(e){console.log("WebSocket异常！")},t.onmessage=function(e){console.log(e.data)},t.onclose=function(){console.log("连接已关闭...")}}catch(e){t=null,console.log(e)}this.ws=t}return r()(e,[{key:"sendMessage",value:function(e){this.ws.send(o()(e))}}]),e}();_.Websocket=function(){return new g},t.a=_}});